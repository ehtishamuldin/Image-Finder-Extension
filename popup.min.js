function getImages(tabId){chrome.tabs.sendMessage(tabId,{action:"getImages"},(response=>{if(chrome.runtime.lastError)console.error("Error retrieving images:",chrome.runtime.lastError.message);else if(response&&response.images){const images=response.images;document.getElementById("image-list").innerHTML="",images.forEach((image=>{if(image.src.startsWith("data:image/gif;base64,"))return;if(image.src.startsWith("data:image/svg+xml;base64,"))return;const row=document.createElement("tr"),imgCell=document.createElement("td"),img=document.createElement("img");img.src=image.src,imgCell.appendChild(img),row.appendChild(imgCell);const detailsCell=document.createElement("td"),urlLink=document.createElement("a");urlLink.href=image.src,urlLink.target="_blank",urlLink.textContent=image.src,image.src.length>50&&(urlLink.textContent=image.src.slice(0,47)+"..."),detailsCell.innerHTML="\n                    <strong>URL:</strong> \n                ",detailsCell.appendChild(urlLink),detailsCell.innerHTML+=`<br><strong>Extension:</strong> ${image.extension}<br><strong>Dimensions:</strong> Width:${image.width}px * Height:${image.height}px`,row.appendChild(detailsCell);const actionCell=document.createElement("td"),downloadBtn=document.createElement("button");downloadBtn.textContent="Download",downloadBtn.classList.add("download-btn"),downloadBtn.onclick=()=>downloadImage(image.src),actionCell.appendChild(downloadBtn),row.appendChild(actionCell);document.getElementById("image-list").appendChild(row)}))}else console.error("No images retrieved.")}))}function downloadImage(url){const a=document.createElement("a");a.href=url,a.download=url.split("/").pop(),document.body.appendChild(a),a.click(),document.body.removeChild(a)}chrome.tabs.query({active:!0,currentWindow:!0},(tabs=>{const tabId=tabs[0].id,tabUrl=tabs[0].url;if(!tabUrl.startsWith("http://")&&!tabUrl.startsWith("https://")){const errorMessage=document.getElementById("error-message");return errorMessage.textContent=`Cannot inject script into this type of page: ${tabUrl}`,void(errorMessage.style.display="block")}chrome.scripting.executeScript({target:{tabId:tabId},files:["contentScript.js"]},(()=>{getImages(tabId)}))}));